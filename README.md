# myhomelab-setup

üõ°Ô∏è Enterprise SOC & Detection Engineering Home Lab!(https://img.shields.io/badge/Security-Blue%20Team-blue)!(https://img.shields.io/badge/Platform-VMware%20%7C%20pfSense-orange)!(https://img.shields.io/badge/SIEM-Wazuh-green!(https://img.shields.io/badge/Platform-VMware%20%7C%20pfSense-orange)!(https://img.shields.io/badge/SIEM-Wazuh-green!(https://img.shields.io/badge/SIEM-Wazuh-green)))üìñ Executive SummaryThis project details the design and implementation of a virtualized Security Operations Center (SOC) environment. Unlike standard "flat" home labs, this setup mimics a real-world enterprise architecture using Network Segmentation via a pfSense firewall to isolate offensive, defensive, and vulnerable assets.The primary goal was to simulate the full lifecycle of a cyber attack: from Infrastructure Setup and Red Team Exploitation to Blue Team Detection and Log Analysis.üèóÔ∏è Network ArchitectureThe lab is hosted on VMware Workstation Pro, utilizing virtual switches (VMnets) to create four isolated subnets routed strictly through a central firewall.Topology Diagram(Place your 'Network Architecture' diagram here, e.g., images/network_diagram.png)ZoneSubnetGatewayComponentIP AddressRoleWANN/ADHCPpfSense (WAN)192.168.1.179Edge ConnectivityAttacker10.0.1.0/2410.0.1.1Kali Linux10.0.1.2Red Team OperationsMonitoring10.0.2.0/2410.0.2.1Wazuh SIEM10.0.2.10Log Aggregation & AnalysisCorp Domain10.0.3.0/2410.0.3.1Windows Server 202210.0.3.10Domain Controller (corp.homelab)Windows 1110.0.3.50Domain User WorkstationVulnerable10.0.4.0/2410.0.4.1Metasploitable 210.0.4.10Intentional Vulnerable Targetüõ†Ô∏è Technologies & ToolsNetwork Defense: pfSense Firewall, Suricata (IDS/IPS).SIEM & Telemetry: Wazuh Manager (v4.7), Wazuh Agents, Sysmon.Identity: Windows Active Directory Domain Services (AD DS).Offensive Tools: NetExec (formerly CrackMapExec), Nmap, Metasploit, Hydra.‚öîÔ∏è Scenarios & Detection EngineeringThis section documents the specific attack vectors tested and the corresponding detection logic implemented.1. Network Reconnaissance (Nmap Stealth Scan)Objective: Detect an attacker attempting to map the network structure using stealth techniques.Attack Command: nmap -sS -p- 10.0.3.10 (Kali Linux)Defense Mechanism: Suricata IDS running on pfSense.Configuration:Created a custom Suricata rule to flag rapid SYN packets without accompanying ACK.Forwarded eve.json logs from pfSense to Wazuh.Result: High-Severity Alert triggered in Wazuh Dashboard: "ET SCAN Nmap Scripting Engine User-Agent Detected".2. Identity Attacks (SMB Brute Force)Objective: Detect a dictionary attack against the Domain Administrator account.Attack Command: netexec smb 10.0.3.10 -u Administrator -p rockyou.txt --ignore-pw-decodingTechnical Challenge: Encountered Python UnicodeDecodeError with the rockyou.txt wordlist. Resolved by using the --ignore-pw-decoding flag in NetExec.Telemetry:Windows Security Log: Spike in Event ID 4625 (An account failed to log on).Logon Type: 3 (Network).Status Code: 0xC000006D (Bad Password).Result: Wazuh correlated 169+ failure events into a single "Brute Force" alert.3. Credential Dumping (Mimikatz)Objective: Detect an attempt to extract plaintext passwords or hashes from memory.Attack Command: sekurlsa::logonpasswordsDefense Mechanism: Sysmon + Wazuh.Configuration:Installed Sysmon on the Domain Controller.Configured sysmonconfig.xml to log Event ID 10 (Process Access).Result: Detected lsass.exe being accessed by mimikatz.exe with GrantedAccess rights indicative of memory reading. Maps to MITRE ATT&CK T1003.001.üì∏ Visuals & Proof of ConceptThe "Vertical Wall" of Alerts(Insert your Wazuh Dashboard screenshot showing the spike in 4625 errors)Visualizing the brute force attack volume in real-time.Suricata Interface on pfSense(Insert your pfSense dashboard screenshot)Managing interface assignments and IDS rules.üöÄ Lessons Learned & Future WorkProtocol Decoding: Learned the importance of UTF-8 encoding handling in Python-based offensive tools (NetExec).Noise vs. Signal: A brute force attack generates massive log volume; tuning SIEM rules to alert on frequency rather than single events is critical to avoid fatigue.Active Response: Future iterations will implement Wazuh's "Active Response" module to automatically block the attacker's IP at the pfSense firewall level upon detection.üë§ Author[LinkedIn Profile Link]
